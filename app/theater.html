<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Causeway | Theater</title>
	<link rel="stylesheet" href="styles/theater.css">
	<link href='http://fonts.googleapis.com/css?family=Vollkorn' rel='stylesheet' type='text/css'>
	<script src="/socket.io/socket.io.js"></script>
</head>
<body>

	<div id="welcome">
			<h1>Causeway</h1>
			<p>Words | <strong>Vincent A. Cellucci</strong></p>
			<p>Audio | <strong>Jesse Allison</strong></p>
			<p>Visuals | <strong>Derick Ostrenko</strong></p>
			<p><em>Instructions: Tapping is the new snapping.</em></p>
			<p class ="url">Visit http://dostrenko-2.lsu.edu:8000 on your mobile device to participate.</p>
	</div>

<div id="causeway-text"></div>

	<script>

 		var socket = io.connect('http://localhost:8000');
 		socket.emit('addme', 'theater');
		
		socket.on('chat', function(data) {
			console.log(data);
		});

		socket.on('itemback', function(data){
			console.log("itemback: " + data);
			var elements = document.getElementsByClassName(data.phrase);
			for(var i = elements.length - 1; i >= 0; --i) {
				elements[i].className += " clicked";
				// elements[i].style.color = data.color;
				// elements[i].style.backgroundColor = data.color;
				elements[i].style.borderColor = data.color;
			}
		});

		socket.on('setSection', function(data) {
			console.log("the section is now: " + data.title);
			if(data.title !== undefined){
				// hidedivs(data.sect);
				document.getElementById("welcome").style.display = "none";
				scrollto(data.sect);
			} else {
				console.log("yep");
				document.getElementById("welcome").style.display = "block";
			}
		});

		window.onload = function() {
			var xhr= new XMLHttpRequest();
			xhr.open('GET', 'data/causeway.html', true);
			xhr.onreadystatechange= function() {
			    if (this.readyState!==4) return;
			    if (this.status!==200) return; // or whatever error handling you want
			    document.getElementById("causeway-text").innerHTML= this.responseText;
			};
			xhr.send();
		};

		function scrollto(element) {
				var ele = document.getElementsByClassName("s"+element)[0];

			    if (!!ele && ele.offsetTop > window.scrollY) {
				    var scrollInterval1 = setInterval(function(){
				    	console.log('scrolling!');
				        if(ele.offsetTop > window.scrollY+3) {
				            window.scrollBy( 0, 12 );
				        } else {
				        	clearInterval(scrollInterval1);
				        }

				    },15);
				}

				if (!!ele && ele.offsetTop < window.scrollY) {
				    var scrollInterval2 = setInterval(function(){
				    	console.log('scrolling!');
				        if(ele.offsetTop < window.scrollY-3) {
				            window.scrollBy( 0, -12 );
				        } else {
				        	clearInterval(scrollInterval2);
				        }

				    },15);
				}
			}

	</script>
</body>
</html>